# 4. 책임과 메시지



## 자율적인 책임

### 설계의 품질을 좌우하는 책임

* 객체지향 공동체를 구성하는 기본 단위는 '**자율적**'인 객체.

* 객체가 어떤 행동을 하는 유일한 이유는 다른 객체로부터 요청을 수신했기 때문이다.

* 요청을 처리하기 위해 객체가 수행하는 행동은 **책임**

* 적절한 책임의 선택이 전체 설계의 방향성 결정.
* 협력에 참여하는 객체의 자율성이 어플리케이션의 품질을 결정

---

* 책임만 완수할 수 있다면 나머지 구체적인 방법이나 절차는 모자장수가 자유롭게 선택.

* 추상적이고 포괄적인 책임은 협력을 조금 더 다양한 환경에서 재사용할 수 있도록 유연성을 부여.
* 요청을 어떻게 처리할지보다 무엇을 처리할지 선택



## 메시지와 메서드

### 메시지

* 외부의 객체는 메시지에 관해서뫈 볼 수 있고 객체 내부는 볼 수 없기 때문에 자연스럽게 객체의 외부와 내부가 분리.

### 메서드

* 메시지를 처리하기 위해 내부적으로 선택하는 방법
* 어떤 객체에 메시지를 전송하면 결과적으로 메시지에 대응되는 특정 메서드가 실행된다.

### 다형성

* 서로 다른 유형의 객체가 동일한 메시지에 대해 서로 다르게 반응하는 것을 의미한다.
* 다형성을 만족시킨다는 것은 객체들이 동일한 책임을 공유한다는 것을 의미한다. (대체가능성)
* 수신자의 종류를 **캡슐화**
* 다형성은 결합도를 낮춘다. (메세지에 대한 결합도, 자료 결합도)
* 송신사자 수신자에 대해 매우 적은 정보만 알고 있더라고 상호 협력이 가능하다는 사실은 설계 품질에 영향
  1. 협력이 유연해진다.
  2. 협력이 수행되는 방식을 확장할 수 있다.
  3. 협력이 수행되는 방식을 재사용할 수 있다.

**메시지를 기반으로 한 두 객체 사이의 이 낮은 결합도가 바로 설계를 유연하고 확장 가능하며 재사용 가능하게 만드는 비결이다.**



## 메시지를 따라라 

### 객체지향의 핵심, 메시지

* 객체지향 어플리케이션의 중심 사상은 연쇄적으로 메시지를 전송하고 수신하는 객체들 사이의 협력관계를 기반으로 사용자에게 유용한 기능 제공
* 클래스를 중심에 두는 설계는 유연하지 못하고 확장하기 어렵다.
* 객체들 사이의 커뮤니케이션에 초점
* 어떤 객체가 어떤 메세지를 전송할  수 있는가와 어떤 객체가 어떤 메시지를 이해할 수 있는가를 중심으로 객체 사이의 협력관계 구성
* **메시지**를 중심으로 **협력** 설계



### 책임-주도 설계 다시 보기

* 책임-주도 설계의 기본 아이디어는 객체들 간에 주고받는 메시지를 기반으로 적절한 역할과 책임, 협력을 발견하는 것이다.
* 수신자는 송신자가 기대한 대로 메시지를 처리할 책임이 있다.
* **메시지가 수신자의 책임을 결정**



### What/who 사이클

* 어떤 행위가 필요한지를 결정하고 먼저 결정한 후에 이 행위를 수행할 객체를 결정하는 것.
* 책임-주도 설계 방법에서는 What/Who 사이클에 따라 협력에 참여할 객체를 결정하기 전에 협력에 필요한 메시지를 먼저 결정한다.
* '**묻지 말고 시켜라**' 스타일은 객체를 자율적으로 만들고 캡슐화를 보장하며 결합도를 낮게 유지시켜 주기 때문에 설계를 유연하게 만든다.



### 메시지를 믿어라

* 객체의 구체적인 타입과 무관하게 전송된 메시지를 이해할 수 있는 객체들을 서로 연결하고 상호 협력 가능하게 만드는 것은 유연하고 재사용 가능한 설계를 낳는 토양이다.
* 다형성은 개별 객체가 아니라 객체들이 주고받는 메시지에 초점을 맞출 떼 비로소 그 진가를 발휘하게 된다.



## 객체 인터페이스

### 인터페이스

* 내부 구조나 동작 방식을 몰라도 쉽게 대상을 조작하거나 의사를 전달할 수 있다.
* 내부 구성이나 작동방식만 병경하는 것은 사용자에게 영향을 미치지 않는다.
* 동일한 인터페이스를 제공하기만 하면 아무런 문제 없이 상호작용할 수 있다.
* 인터페이스만 유지되면 다른 객체로 바꿔도 문제가 되지 않는다.



### 공용 인터페이스

* 자기 자신과의 상호작용 역시 메시지를 통해서.
* 객체의 공용 인터페이스를 구성하는 것은 객체가 외부로부터 수신할 수 있는 메시지의 목록.



#### 요약

1. 협력에 참여하는 객체의 책임이 자율적이어야 한다.
2. 객체가 메시지를 수신했을 때 적절한 객체의 수행된다.
   * 다형성을 통해 다양한 타입의 객체 수용 가능
3. 어떤 메시지를 수신할 수 있느냐가 어떤 책임을 수행할 수 있느냐와 어떤 인터페이스를 가질 것인지를 결정



## 인터페이스와 구현의 분리

1. 조금 더 추상적인 인터페이스
2. 최소 인터페이스
3. 인터페이스와 구현 사이의 차이



### 구현

* 객체의 상태를 어떻게 표현할 것인가.
* 메서드를 구성하는 코드 자체
* 객체의 내부와 외부를 분리하라는 것은 객체의 공용 인터페이스와 구현을 명확하게 분리



### 인터페이스와 구현의 분리 원칙

* 훌륭한 객체란 구현을 모른 채 인터페이스만 알면 쉽게 상호작용할 수 있는 객체를 의미한다.
* 적절한 구현을 선태가고 이를 인터페이스 뒤로 감추는 것은 객체의 자율성 향상.



### 캡슐화 (정보은닉)

1. 상태와 행위의 캡슐화
   * 객체는 상태와 행위를 한데 묶은 후 외부에서 반드시 접근해야만 하는 행위만 골라 공용 인터페이스에 노출한다.
   * 데이터와 프로세스를 객체라는 하나의 틀 안으로 함께 묶어 놓음으로써 객체의 자율성 보장.
2. 사적인 비밀의 캡슐화
   * 캡슐화를 통해 변경이 빈번하게 일어나는 불안정한 비밀을 안정적인 인터페이스 뒤로 숨길 수 있다.
   * 객체는 공용 인터페이스를 경계로 최대한의 자율성을 보장받을 수 있다.



## 책임의 자율성이 협력의 품질을 결정한다.

이해하기 쉽고 변경에 유연한 것이 좋은 협력.

1. 자율적인 책임은 세부적인 사항들을 무시하고 의도를 드러내는 하나의 문장으로 표현함으로써 협력을 단순하게 만든다.

   > 추상화

2. 책임만 완수할 수 있다면 어떤 방법을 선택할지는 자유, 내부와 외부의 분리

   > 자율성

3. 책임을 수행하는 내부적인 방법을 변경하더라도 외부에 영향을 미치지 않는다. 책임이 자율적일수록 변경에 의해 수정돼야 하는 범위가 좁아지고 명확해진다.

   > 캡슐화, 결합도

4. 자율적인 책임은 협력의 대상을 다양하게 선택할 수 있는 유연성을 제공

   > 다형성

5. 객체의 역할을 이해하기 쉬워진다. 객체는 동일한 목적을 달성하는 강하게 연간된 책임으로 구성.

   > 응집도