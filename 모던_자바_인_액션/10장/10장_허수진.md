# Chapter10 람다를 이용한 도메인 전용 언어
프로그래밍 언어도 결국 언어라는 사실을 잊곤 한다. 
언어의 주요 목표는 메시지를 명확하고, 안정적인 방식으로 전달하는 것이다.

> 프로그램은 사람들이 이해할 수 있도록 작성되어야 하는 것이 중요하며,
> 기기가 실행하는 부분은 부차적일 뿐 - 컴퓨터 과학자 하롤드 아벨슨

## DSL(도메인 전용 언어)
도메인 전용 언어를 사용함으로 읽기 쉽고 이해하기 쉬운 코드를 만들 수 있다. 
DSL은 특정 비즈니스 도메인의 문제를 해결하려고 만든 언어다.
범용 프로그래밍 언어가 아니라, 동작과 용어가 특정 도메인에 국횐되어
오직 자신의 눈 앞에 놓인 문제를 해결할지에만 집중할 수 있다. 

- 의사 소통 : 코드가 명확히 전달되어야하며, 프로그래머가 아닌 사람도 이해해야함
- 여러번 읽기 : 가독성은 유지보수의 핵심이다. 


### 플루언트 스타일
자바 루프를 스트림 API 로 풀어서 작성한 것을 의미한다.
기본적으로 DSL 을 만드려면 앱 수준 프로그래머에 어떤 동작이 필요한지 고민이 필요함

## 장단점
| 장점 | 단점 |
|----|----|
|간결함|설계 어려움|
|가독성|개발비용|
|유지보수|추가 우회계층|



### 메서드 체인
메서드가 마치 체인처럼 연결되어 있다고 해서 메서드 체인이다. 


### 내부 DSL
자바로 구현한 DSL을 의미힌다.
역사적으로 자바는 다소 귀찮고, 유연성이 떨어지는 문법 때문에 읽기 쉽고, 
간단하고, 표현력 있는 DSL을 만드는데 한계가 있었다. 람다 표현식이 등장하면서 이 문제가 어느정도 해결될 수 있다. 

```java 
List<String> numbers = Arrays.asList("one", "two", "three");
numbers.forEach(new Consumer<String>() {        //numbers.forEach
@Override
public void accept(String s){                //accept
System.out.println(s)                    //전체
}
})
위에서 주석으로 처리한 부분이 코드의 잡음이다. 이를 자바 8에서는 많이 줄어든다.

numbers.forEach(System.out::println);
// 순수 자바로 DSL을 구현함으로 다음과 같은 장점을 얻을 수 있다.

```


### 다중 DSL
DSL은 기반 프로그래밍 언어의 영향을 받으므로 간결한 DSL을 만드는 데 새로운 언어의 특성들이 아주 중요하다.

예를 들어 스칼라에서는 자바에서 얻기 힘든 장점들을 얻을 수 있다. 그러나 이와 같은 접근은 불편함도 초래한다.

- 새로운 프로그래밍 언어를 배우거나 또는 팀의 누군가가 이미 해당 기술을 가지고 있어야 한다. 
- 멋진 DSL을 만들려면 이미 기존 언어의 고급 기능을 사용할 수 있는 충분한 지식이 필요하기 때문이다.
- 두 개 이상의 언어가 혼재하므로 여러 컴파일러로 소스를 빌드하도록 빌드 과정을 개선해야 한다.
- JVM에서 실행되는 거의 모든 언어가 자바와 백 퍼센트 호환을 주장하고 있지만 자바와 호환성이 완벽하지 않을 때가 많다. 이러한 이유로 성능이 손실될 때도 있다.

### 스트림 API는 컬렉션을 조작하는 DSL

- Stream 인터페이스는 네이티브 자바 API에 작은 내부 DSL을 적용한 좋은 예다.
- 사실 Stream으 컬렉션의 항목을 필터, 정렬, 변환, 그룹화, 조작하는 작지만 강력한 DSL로 볼 수 있다.
```java 
List<String> errors = new ArrayList<>();
int errorCount = 0;
BufferedReader br = new BufferedReader(new FileReader(fileName));
String line = br.readLine();
while(errorCount < 40 && line != null) {
    if(line.startWith("ERROR")){
    errors.add(line);
    errorCount++;   
    }
    line = br.readLine();
    
/// Stream 인터페이스를 이용해 함수형으로 코드를 구현하면 다음과 같이 가독성이 좋게끔 간결하게 코드를 구현할 수 있다.

List<String> errors = File.lines(Paths.get(fileName))    //파일을 열어서 문자열 스트림을 만듦
                            .filter(line -> line.startWith("ERROR"))
                            .limit(40)
                            .collect(toList());
}
```